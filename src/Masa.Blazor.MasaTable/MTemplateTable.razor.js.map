{"version":3,"file":"MTemplateTable.razor.js","sources":["../Masa.Blazor.JS/src/components/configurable-table/index.ts"],"sourcesContent":["class ResizableDataTable {\r\n  private dataTable: HTMLElement;\r\n  private dotnetHelper: DotNet.DotNetObject;\r\n  private table: HTMLTableElement;\r\n  private header: HTMLTableRowElement;\r\n  private pageX: number;\r\n  private curCol: HTMLElement;\r\n  private nxtCol: HTMLElement;\r\n  private curColWidth: number;\r\n  private nxtColWidth: number;\r\n  private tableWidth: number;\r\n  private documentEventRegistered: boolean;\r\n\r\n  constructor(dataTable: HTMLElement, dotNETHelper: DotNet.DotNetObject) {\r\n    this.dataTable = dataTable;\r\n    this.dotnetHelper = dotNETHelper;\r\n    this.table = this.dataTable.querySelector(\"table\");\r\n    this.header = this.table.querySelector(\"thead\").getElementsByTagName(\"tr\")[0];\r\n    this.documentEventRegistered = false;\r\n\r\n    this.init();\r\n  }\r\n\r\n  private init() {\r\n    if (!this.documentEventRegistered) {\r\n      document.addEventListener(\"mousemove\", this.mousemove.bind(this));\r\n      document.addEventListener(\"mouseup\", this.mouseup.bind(this));\r\n      this.documentEventRegistered = true;\r\n    }\r\n\r\n    this.header.addEventListener(\"mousedown\", this.wrapperMousedown.bind(this));\r\n  }\r\n\r\n  private paddingDiff(col: HTMLElement): number {\r\n    if (this.getStyleVal(col, \"box-sizing\") == \"border-box\") {\r\n      return 0;\r\n    }\r\n\r\n    const padLeft = this.getStyleVal(col, \"padding-left\");\r\n    const padRight = this.getStyleVal(col, \"padding-right\");\r\n    return parseInt(padLeft) + parseInt(padRight);\r\n  }\r\n\r\n  private getStyleVal(elm: HTMLElement, css: string): string {\r\n    return window.getComputedStyle(elm, null).getPropertyValue(css);\r\n  }\r\n\r\n  private wrapperMousedown(e: MouseEvent) {\r\n    if (e.target instanceof HTMLElement && e.target.classList.contains(\"masa-table-viewer__header-column-resize\")) {\r\n      this.mousedown(e);\r\n    }\r\n  }\r\n\r\n  private mousedown(e: MouseEvent) {\r\n    this.curCol = (e.target as HTMLElement).parentElement;\r\n    this.nxtCol = this.curCol.nextElementSibling as HTMLElement;\r\n    this.pageX = e.pageX;\r\n\r\n    this.tableWidth = this.table.offsetWidth;\r\n\r\n    const padding = this.paddingDiff(this.curCol);\r\n\r\n    this.curColWidth = this.curCol.offsetWidth - padding;\r\n    if (this.nxtCol) this.nxtColWidth = this.nxtCol.offsetWidth - padding;\r\n  }\r\n\r\n  private mousemove(e: MouseEvent) {\r\n    if (this.curCol) {\r\n      let diffX = e.pageX - this.pageX;\r\n\r\n      const isRtl = this.dataTable.classList.contains(\"m-data-table--rtl\");\r\n      if (isRtl) {\r\n        diffX = 0 - diffX;\r\n      }\r\n\r\n      let newCurColWidth = this.curColWidth + diffX;\r\n\r\n      const minWidth = getComputedStyle(this.curCol).minWidth;\r\n      if (minWidth && newCurColWidth < parseInt(minWidth)) {\r\n        newCurColWidth = parseInt(minWidth);\r\n        diffX = newCurColWidth - this.curColWidth;\r\n      }\r\n\r\n      const maxWidth = 300;\r\n      if (newCurColWidth > maxWidth) {\r\n        newCurColWidth = maxWidth;\r\n        diffX = newCurColWidth - this.curColWidth;\r\n      }\r\n\r\n      const columnId = this.curCol.getAttribute(\"data-id\");\r\n      this.dotnetHelper.invokeMethodAsync(\"OnColumnWidthResize\", columnId, newCurColWidth);\r\n\r\n      this.curCol.style.width = newCurColWidth + \"px\";\r\n      this.table.style.width = this.tableWidth + diffX + \"px\";\r\n    }\r\n  }\r\n\r\n  private mouseup(e: MouseEvent) {\r\n    this.curCol = undefined;\r\n    this.nxtCol = undefined;\r\n    this.pageX = undefined;\r\n    this.nxtColWidth = undefined;\r\n    this.curColWidth = undefined;\r\n    this.tableWidth = undefined;\r\n  }\r\n\r\n  public dispose() {\r\n    this.header.removeEventListener(\"mousedown\", this.wrapperMousedown.bind(this));\r\n    document.removeEventListener(\"mousemove\", this.mousemove.bind(this));\r\n    document.removeEventListener(\"mouseup\", this.mouseup.bind(this));\r\n    this.documentEventRegistered = false;\r\n    this.dotnetHelper.dispose();\r\n  }\r\n}\r\n\r\nexport function init(  dataTable: HTMLElement,  dotNETHelper: DotNet.DotNetObject) {\r\n  return new ResizableDataTable(dataTable, dotNETHelper);\r\n}\r\n"],"names":[],"mappings":"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"}