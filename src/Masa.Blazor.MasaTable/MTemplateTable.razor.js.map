{"version":3,"file":"MTemplateTable.razor.js","sources":["../Masa.Blazor.JS/src/components/configurable-table/index.ts"],"sourcesContent":["export function resizableDataTable(dataTable: HTMLElement, dotNETHelper: DotNet.DotNetObject) {\n  const table = dataTable.querySelector(\"table\");\n  const header = table.querySelector(\"thead\").getElementsByTagName(\"tr\")[0];\n\n  let pageX: number;\n  let curCol: HTMLElement;\n  let nxtCol: HTMLElement;\n  let curColWidth: number;\n  let nxtColWidth: number;\n  let tableWidth: number;\n  let documentEventRegistered = false;\n\n  var observer = new MutationObserver(function (mutations) {\n    mutations.forEach(function (mutation) {\n      if (mutation.addedNodes.length) {\n        (Array.from(mutation.addedNodes) as HTMLElement[]).forEach((el) => {\n          const resizeActivator: HTMLDivElement = el.querySelector(\n            \".masa-table-viewer__header-column-resize\"\n          );\n          if (resizeActivator) {\n            setListeners(resizeActivator);\n          }\n        });\n      }\n\n      if (mutation.removedNodes.length) {\n        (Array.from(mutation.removedNodes) as HTMLElement[]).forEach((el) => {\n          const resizeActivator: HTMLDivElement = el.querySelector(\n            \".masa-table-viewer__header-column-resize\"\n          );\n          if (resizeActivator) {\n            resizeActivator.removeEventListener(\"mousedown\", mousedown);\n          }\n        });\n      }\n    });\n  });\n\n  header && observer.observe(header, { childList: true });\n\n  const cols = header ? header.children : [];\n  if (!cols) return;\n\n  for (var i = 0; i < cols.length; i++) {\n    const col: any = cols[i];\n    const colResizeDiv: HTMLDivElement = col.querySelector(\n      \".masa-table-viewer__header-column-resize\"\n    );\n    if (!colResizeDiv) continue;\n\n    setListeners(colResizeDiv);\n  }\n\n  function setListeners(div: HTMLDivElement) {\n    div.addEventListener(\"click\", (e) => e.stopPropagation());\n    div.addEventListener(\"mousedown\", mousedown);\n\n    if (documentEventRegistered === false) {\n      document.addEventListener(\"mousemove\", mousemove);\n      document.addEventListener(\"mouseup\", mouseup);\n    }\n  }\n\n  function paddingDiff(col) {\n    if (getStyleVal(col, \"box-sizing\") == \"border-box\") {\n      return 0;\n    }\n\n    var padLeft = getStyleVal(col, \"padding-left\");\n    var padRight = getStyleVal(col, \"padding-right\");\n    return parseInt(padLeft) + parseInt(padRight);\n  }\n\n  function getStyleVal(elm, css) {\n    return window.getComputedStyle(elm, null).getPropertyValue(css);\n  }\n\n  function mousedown (e: MouseEvent) {\n    curCol = (e.target as HTMLElement).parentElement;\n    nxtCol = curCol.nextElementSibling as HTMLElement;\n    pageX = e.pageX;\n\n    tableWidth = table.offsetWidth;\n\n    var padding = paddingDiff(curCol);\n\n    curColWidth = curCol.offsetWidth - padding;\n    if (nxtCol) nxtColWidth = nxtCol.offsetWidth - padding;\n  };\n\n  function mousemove(e: MouseEvent) {\n    if (curCol) {\n      let diffX = e.pageX - pageX;\n\n      const isRtl = dataTable.classList.contains(\"m-data-table--rtl\");\n      if (isRtl) {\n        diffX = 0 - diffX;\n      }\n\n      let newCurColWidth = curColWidth + diffX;\n\n      const minWidth = getComputedStyle(curCol).minWidth;\n      if (minWidth && newCurColWidth < parseInt(minWidth)) {\n        newCurColWidth = parseInt(minWidth);\n        diffX = newCurColWidth - curColWidth;\n      }\n\n      const maxWidth = 300;\n      if (newCurColWidth > maxWidth) {\n        newCurColWidth = maxWidth;\n        diffX = newCurColWidth - curColWidth;\n      }\n\n      const columnId = curCol.getAttribute('data-column-id');\n      dotNETHelper.invokeMethodAsync(\"OnColumnWidthResize\", columnId, newCurColWidth);\n\n      curCol.style.width = newCurColWidth + \"px\";\n      table.style.width = tableWidth + diffX + \"px\";\n    }\n  };\n\n  function mouseup(e: MouseEvent) {\n    if (curCol) {\n      for (let i = 0; i < cols.length; i++) {\n        const col: any = cols[i];\n        col.style.width = col[\"offsetWidth\"] + \"px\";\n      }\n    }\n    curCol = undefined;\n    nxtCol = undefined;\n    pageX = undefined;\n    nxtColWidth = undefined;\n    curColWidth = undefined;\n    tableWidth = undefined;\n  };\n}\n"],"names":[],"mappings":"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"}