@namespace Masa.Blazor.Presets
@inherits NextTickComponentBase

<CascadingValue Value="this" IsFixed>
    <MTabs Routable Class="@($"m-page-tabs {Class}")" Style="@Style" HideSlider="@HideSlider" @ref="@_tabs">
        @foreach (var path in _absolutePaths)
        {
            <MTab Href="@path"
                  Class="@($"m-page-tab {TabClass}")"
                  Exact
                  Ripple="@Ripple"
                  @key="@path"
                  @oncontextmenu="(e) => HandleOnContextmenu(e, path)"
                  __internal_preventDefault_oncontextmenu>
                @if (TabContent != default)
                {
                    @TabContent.Invoke(new PageTabPathValue(path, path == NavigationManager.GetAbsolutePath()))
                }
                else
                {
                    @path
                }

                <MButton Icon
                         OnClick="() => HandleOnCloseTab(path)"
                         Small
                         StopPropagation
                         OnClickPreventDefault>
                    <MIcon Small>mdi-close</MIcon>
                </MButton>
            </MTab>
        }

        <MMenu @bind-Value="_menuValue"
               Absolute
               OffsetY
               PositionX="@_positionX"
               PositionY="@_positionY"
               CloseOnContentClick>
            <MList Dense>
                <MListItem OnClick="ReloadTab">@ReloadTabText</MListItem>
                <MListItem OnClick="CloseTabsToTheLeft">@CloseTabsToTheLeftText</MListItem>
                <MListItem OnClick="CloseTabsToTheRight">@CloseTabsToTheRightText</MListItem>
                <MListItem OnClick="CloseOtherTabs">@CloseOtherTabsText</MListItem>
            </MList>
        </MMenu>
    </MTabs>

    @ChildContent
</CascadingValue>
