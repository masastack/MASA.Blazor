import{u as t}from"../../chunks/touch.js";import{a as e}from"../../chunks/helper.js";import"../../chunks/tslib.es6.js";function n(n,o,c){const s=e(n);if(!s)return;window.addEventListener("touchstart",w,{passive:!0}),window.addEventListener("touchmove",y,{passive:!1}),window.addEventListener("touchend",M,{passive:!0});const r=["left","right"].includes(c.position),{addMovement:u,endTouch:d,getVelocity:a}=t();let m,l=!1,h=!1,p=0,f=0;function v(t,e){return("left"===c.position?t:"right"===c.position?document.documentElement.clientWidth-t:i())-(e?document.documentElement.clientWidth:0)}function E(t,e=!0){const n="left"===c.position?(t-f)/document.documentElement.clientWidth:"right"===c.position?(document.documentElement.clientWidth-t-f)/document.documentElement.clientWidth:i();return e?Math.max(0,Math.min(1,n)):n}function g(t){const e=t.target.closest(".m-page-stack-item");return e&&e.parentElement===s}function w(t){if(!g(t))return;const e=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY,o="left"===c.position?e<25:"right"===c.position?e>document.documentElement.clientWidth-25:i(),s=c.isActive&&("left"===c.position?e<document.documentElement.clientWidth:"right"===c.position?e>0:i());(o||s||c.isActive)&&(m=[e,n],f=v(r?e:n,c.isActive),p=E(r?e:n),l=f>-20&&f<80,d(t),u(t))}function y(t){if(!g(t))return;const e=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY;if(l){if(!t.cancelable)return void(l=!1);const i=Math.abs(e-m[0]),o=Math.abs(n-m[1]);(r?i>o&&i>3:o>i&&o>3)?(h=!0,l=!1):(r?o:i)>3&&(l=!1)}if(!h)return;t.preventDefault(),u(t);const i=E(r?e:n,!1);p=Math.max(0,Math.min(1,i)),i>1?f=v(r?e:n,!0):i<0&&(f=v(r?e:n,!1)),W()}function M(t){if(!g(t))return;if(l=!1,!h)return;u(t),h=!1;const e=a(t.changedTouches[0].identifier),n=Math.abs(e.x),s=Math.abs(e.y),d=r?n>s&&n>400:s>n&&s>3;c.isActive=d?e.direction===({left:"right",right:"left",top:"down",bottom:"up"}[c.position]||i()):p>.5,W(),setTimeout((()=>o.invokeMethodAsync("TouchEnd",c.isActive)),200)}const W=()=>{if(h){const t="left"===c.position?`translateX(calc(-100% + ${p*document.documentElement.clientWidth}px))`:"right"===c.position?`translateX(calc(100% - ${p*document.documentElement.clientWidth}px))`:i();s.style.setProperty("transform",t),s.style.setProperty("transition","none")}else c.isActive?s.style.removeProperty("transform"):s.style.setProperty("transform","translateX(100%)"),s.style.removeProperty("transition")};return{syncState:t=>{c=t},dispose:()=>{o.dispose(),window.removeEventListener("touchstart",w),window.removeEventListener("touchmove",y),window.removeEventListener("touchend",M)}}}function i(){throw new Error}export{n as useTouch};
//# sourceMappingURL=touch.js.map
