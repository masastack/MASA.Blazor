{"version":3,"file":"index.js","sources":["../../../../../Masa.Blazor.JS/src/components/transition/index.ts"],"sourcesContent":["import { getBlazorId } from \"utils/helper\";\r\n\r\nclass Transition {\r\n  el: HTMLElement;\r\n  handle?: DotNet.DotNetObject;\r\n\r\n  constructor(elOrSelector: HTMLElement, handle: DotNet.DotNetObject) {\r\n    this.handle = handle;\r\n    this.el = elOrSelector;\r\n    this.el.addEventListener(\"transitionend\", this._onTransitionEnd);\r\n    this.el.addEventListener(\"transitioncancel\", this._onTransitionCancel);\r\n  }\r\n\r\n  _onTransitionEnd = (e: TransitionEvent) => {\r\n    const leaveEnter = this._getTransitionLeaveEnter(e);\r\n    if (!leaveEnter) return;\r\n\r\n    this.handle &&\r\n      this.handle.invokeMethodAsync(\r\n        \"OnTransitionEnd\",\r\n        getBlazorId(e.target),\r\n        leaveEnter == \"leave\" ? 0 : 1\r\n      );\r\n  };\r\n\r\n  _onTransitionCancel = (e: TransitionEvent) => {\r\n    const leaveEnter = this._getTransitionLeaveEnter(e);\r\n    if (!leaveEnter) return;\r\n\r\n    this.handle &&\r\n      this.handle.invokeMethodAsync(\r\n        \"OnTransitionCancel\",\r\n        getBlazorId(e.target),\r\n        leaveEnter == \"leave\" ? 0 : 1\r\n      );\r\n  };\r\n\r\n  _getTransitionLeaveEnter(e: TransitionEvent): \"leave\" | \"enter\" | undefined {\r\n    const classNames = e.target.className.split(\" \");\r\n    if (classNames.some((n) => n.includes(\"transition-leave\"))) {\r\n      return \"leave\";\r\n    } else if (classNames.some((n) => n.includes(\"transition-enter\"))) {\r\n      return \"enter\";\r\n    } else {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  reset(el: HTMLElement) {\r\n    this.el.removeEventListener(\"transitionend\", this._onTransitionEnd);\r\n    this.el.removeEventListener(\"transitioncancel\", this._onTransitionCancel);\r\n    this.el = el;\r\n    this.el.addEventListener(\"transitionend\", this._onTransitionEnd);\r\n    this.el.addEventListener(\"transitioncancel\", this._onTransitionCancel);\r\n  }\r\n\r\n  dispose() {\r\n    this.el.removeEventListener(\"transitionend\", this._onTransitionEnd);\r\n    this.el.removeEventListener(\"transitioncancel\", this._onTransitionCancel);\r\n\r\n    delete transitionInstances[this.handle[\"_id\"]];\r\n    this.handle.dispose();\r\n    this.handle = null;\r\n  }\r\n}\r\n\r\n// Store all instances of transition,\r\n// avoid creating multiple instances of the same element,\r\n// because we can't guarantee that js interop will only call the instantiation method once\r\nlet transitionInstances = {\r\n  number: Transition,\r\n};\r\n\r\nfunction init(elOrSelector: HTMLElement | string, handle: DotNet.DotNetObject) {\r\n  let el: HTMLElement;\r\n  if (typeof elOrSelector === \"string\") {\r\n    el = document.querySelector(elOrSelector);\r\n  } else {\r\n    el = elOrSelector;\r\n  }\r\n\r\n  if (!el || !handle) {\r\n    return null;\r\n  }\r\n\r\n  const dotNetObjectId = handle[\"_id\"];\r\n\r\n  if (transitionInstances[dotNetObjectId]) {\r\n    return transitionInstances[dotNetObjectId];\r\n  }\r\n\r\n  const transitionEl = new Transition(el, handle);\r\n  transitionInstances[dotNetObjectId] = transitionEl;\r\n\r\n  return transitionEl;\r\n}\r\n\r\nexport { init };\r\n"],"names":["Transition","constructor","elOrSelector","handle","this","_onTransitionEnd","e","leaveEnter","_getTransitionLeaveEnter","invokeMethodAsync","getBlazorId","target","_onTransitionCancel","el","addEventListener","classNames","className","split","some","n","includes","reset","removeEventListener","dispose","transitionInstances","number","init","document","querySelector","dotNetObjectId","transitionEl"],"mappings":"2CAEA,MAAMA,EAIJ,WAAAC,CAAYC,EAA2BC,GAOvCC,KAAAC,iBAAoBC,IAClB,MAAMC,EAAaH,KAAKI,yBAAyBF,GAC5CC,GAELH,KAAKD,QACHC,KAAKD,OAAOM,kBACV,kBACAC,EAAYJ,EAAEK,QACA,SAAdJ,EAAwB,EAAI,EAC7B,EAGLH,KAAAQ,oBAAuBN,IACrB,MAAMC,EAAaH,KAAKI,yBAAyBF,GAC5CC,GAELH,KAAKD,QACHC,KAAKD,OAAOM,kBACV,qBACAC,EAAYJ,EAAEK,QACA,SAAdJ,EAAwB,EAAI,EAC7B,EA3BHH,KAAKD,OAASA,EACdC,KAAKS,GAAKX,EACVE,KAAKS,GAAGC,iBAAiB,gBAAiBV,KAAKC,kBAC/CD,KAAKS,GAAGC,iBAAiB,mBAAoBV,KAAKQ,oBACnD,CA0BD,wBAAAJ,CAAyBF,GACvB,MAAMS,EAAaT,EAAEK,OAAOK,UAAUC,MAAM,KAC5C,OAAIF,EAAWG,MAAMC,GAAMA,EAAEC,SAAS,sBAC7B,QACEL,EAAWG,MAAMC,GAAMA,EAAEC,SAAS,sBACpC,aAEP,CAEH,CAED,KAAAC,CAAMR,GACJT,KAAKS,GAAGS,oBAAoB,gBAAiBlB,KAAKC,kBAClDD,KAAKS,GAAGS,oBAAoB,mBAAoBlB,KAAKQ,qBACrDR,KAAKS,GAAKA,EACVT,KAAKS,GAAGC,iBAAiB,gBAAiBV,KAAKC,kBAC/CD,KAAKS,GAAGC,iBAAiB,mBAAoBV,KAAKQ,oBACnD,CAED,OAAAW,GACEnB,KAAKS,GAAGS,oBAAoB,gBAAiBlB,KAAKC,kBAClDD,KAAKS,GAAGS,oBAAoB,mBAAoBlB,KAAKQ,4BAE9CY,EAAoBpB,KAAKD,OAAY,KAC5CC,KAAKD,OAAOoB,UACZnB,KAAKD,OAAS,IACf,EAMH,IAAIqB,EAAsB,CACxBC,OAAQzB,GAGV,SAAS0B,EAAKxB,EAAoCC,GAChD,IAAIU,EAOJ,GALEA,EAD0B,iBAAjBX,EACJyB,SAASC,cAAc1B,GAEvBA,GAGFW,IAAOV,EACV,OAAO,KAGT,MAAM0B,EAAiB1B,EAAY,IAEnC,GAAIqB,EAAoBK,GACtB,OAAOL,EAAoBK,GAG7B,MAAMC,EAAe,IAAI9B,EAAWa,EAAIV,GAGxC,OAFAqB,EAAoBK,GAAkBC,EAE/BA,CACT"}