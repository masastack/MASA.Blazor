{"version":3,"file":"index-0cf62978.js","sources":["../../../../../Masa.Blazor.JS/src/components/scroll-to-target/index.ts"],"sourcesContent":["import debounceIt from \"just-debounce-it\";\r\n\r\nimport { formatToStandardOptions, IntersectionObserverOptions } from \"../../mixins/intersect\";\r\n\r\nclass ScrollToTargetJSInterop {\r\n  activeStack: string[] = [];\r\n  handle: DotNet.DotNetObject;\r\n  options?: IntersectionObserverInit | null;\r\n  debouncedUpdate: () => void;\r\n\r\n  constructor(\r\n    handle: DotNet.DotNetObject,\r\n    options?: IntersectionObserverOptions\r\n  ) {\r\n    this.handle = handle;\r\n    this.options = formatToStandardOptions(options);\r\n\r\n    this.debouncedUpdate = debounceIt(async () => {\r\n      await this.handle.invokeMethodAsync(\r\n        \"UpdateActiveTarget\",\r\n        this.activeStack[this.activeStack.length - 1]\r\n      );\r\n    }, 16);\r\n  }\r\n\r\n  observe(id: string) {\r\n    const el = document.getElementById(id);\r\n    if (!el) {\r\n      console.warn(`[ScrollToTarget] Element with id '${id}' not found`);\r\n      return;\r\n    }\r\n\r\n    if (el[\"_intersectForScrollToTarget\"]) {\r\n      return;\r\n    }\r\n\r\n    const observer = new IntersectionObserver(\r\n      async (\r\n        entries: IntersectionObserverEntry[] = [],\r\n        observer: IntersectionObserver\r\n      ) => {\r\n        const isIntersecting = entries.some((e) => e.isIntersecting);\r\n        if (isIntersecting) {\r\n          this.activeStack.push(id);\r\n        } else if (this.activeStack.includes(id)) {\r\n          this.activeStack.splice(this.activeStack.indexOf(id), 1);\r\n        }\r\n\r\n        this.debouncedUpdate();\r\n      },\r\n      this.options\r\n    );\r\n\r\n    el[\"_intersectForScrollToTarget\"] = Object(el[\"_intersectForScrollToTarget\"]);\r\n    el[\"_intersectForScrollToTarget\"] = { handle: this.handle, observer };\r\n\r\n    observer.observe(el);\r\n  }\r\n\r\n  unobserve(id: string) {\r\n    const el = document.getElementById(id);\r\n    if (!el) return;\r\n\r\n    const observe = el[\"_intersectForScrollToTarget\"];\r\n    if (!observe) return;\r\n\r\n    observe.observer.unobserve(el);\r\n    delete el[\"_intersectForScrollToTarget\"];\r\n  }\r\n\r\n  dispose() {\r\n    if (this.handle) {\r\n      this.handle.dispose();\r\n      this.handle = null\r\n    }\r\n  }\r\n}\r\n\r\nfunction init(\r\n  handle: DotNet.DotNetObject,\r\n  options?: IntersectionObserverOptions\r\n) {\r\n  return new ScrollToTargetJSInterop(handle, options);\r\n}\r\n\r\nexport { init };\r\n"],"names":["ScrollToTargetJSInterop","constructor","handle","options","this","activeStack","formatToStandardOptions","debouncedUpdate","debounceIt","__awaiter","invokeMethodAsync","length","observe","id","el","document","getElementById","console","warn","observer","IntersectionObserver","entries","some","e","isIntersecting","push","includes","splice","indexOf","Object","unobserve","dispose","init"],"mappings":"qOAIA,MAAMA,EAMJ,WAAAC,CACEC,EACAC,GAPFC,KAAWC,YAAa,GAStBD,KAAKF,OAASA,EACdE,KAAKD,QAAUG,EAAwBH,GAEvCC,KAAKG,gBAAkBC,EAAW,IAAWC,EAAAL,UAAA,OAAA,EAAA,kBACrCA,KAAKF,OAAOQ,kBAChB,qBACAN,KAAKC,YAAYD,KAAKC,YAAYM,OAAS,GAE/C,GAAG,GACJ,CAED,OAAAC,CAAQC,GACN,MAAMC,EAAKC,SAASC,eAAeH,GACnC,IAAKC,EAEH,YADAG,QAAQC,KAAK,qCAAqCL,gBAIpD,GAAIC,EAAgC,4BAClC,OAGF,MAAMK,EAAW,IAAIC,qBACnB,CACEC,EAAuC,GACvCF,IACEV,EAAAL,UAAA,OAAA,EAAA,YACqBiB,EAAQC,KAAMC,GAAMA,EAAEC,gBAE3CpB,KAAKC,YAAYoB,KAAKZ,GACbT,KAAKC,YAAYqB,SAASb,IACnCT,KAAKC,YAAYsB,OAAOvB,KAAKC,YAAYuB,QAAQf,GAAK,GAGxDT,KAAKG,iBACP,GACAH,KAAKD,SAGPW,EAAgC,4BAAIe,OAAOf,EAAgC,6BAC3EA,EAAgC,4BAAI,CAAEZ,OAAQE,KAAKF,OAAQiB,YAE3DA,EAASP,QAAQE,EAClB,CAED,SAAAgB,CAAUjB,GACR,MAAMC,EAAKC,SAASC,eAAeH,GACnC,IAAKC,EAAI,OAET,MAAMF,EAAUE,EAAgC,4BAC3CF,IAELA,EAAQO,SAASW,UAAUhB,UACpBA,EAAgC,4BACxC,CAED,OAAAiB,GACM3B,KAAKF,SACPE,KAAKF,OAAO6B,UACZ3B,KAAKF,OAAS,KAEjB,EAGH,SAAS8B,EACP9B,EACAC,GAEA,OAAO,IAAIH,EAAwBE,EAAQC,EAC7C"}