{"version":3,"file":"index.js","sources":["../../../../../Masa.Blazor.JS/src/components/scroll-to-target/index.ts"],"sourcesContent":["import { formatToStandardOptions, IntersectionObserverOptions } from \"../../mixins/intersect\";\r\n\r\nclass ScrollToTargetJSInterop {\r\n  activeStack: string[] = [];\r\n  handle: DotNet.DotNetObject;\r\n  options?: IntersectionObserverInit | null;\r\n\r\n  constructor(\r\n    handle: DotNet.DotNetObject,\r\n    options?: IntersectionObserverOptions\r\n  ) {\r\n    this.handle = handle;\r\n    this.options = formatToStandardOptions(options);\r\n  }\r\n\r\n  observe(id: string) {\r\n    const el = document.getElementById(id);\r\n    if (!el) {\r\n      console.warn(`[ScrollToTarget] Element with id '${id}' not found`);\r\n      return;\r\n    }\r\n\r\n    if (el[\"_intersectForScrollToTarget\"]) {\r\n      return;\r\n    }\r\n\r\n    const observer = new IntersectionObserver(\r\n      async (\r\n        entries: IntersectionObserverEntry[] = [],\r\n        observer: IntersectionObserver\r\n      ) => {\r\n        const isIntersecting = entries.some((e) => e.isIntersecting);\r\n        if (isIntersecting) {\r\n          this.activeStack.push(id);\r\n        } else if (this.activeStack.includes(id)) {\r\n          this.activeStack.splice(this.activeStack.indexOf(id), 1);\r\n        }\r\n\r\n        await this.handle.invokeMethodAsync(\r\n          \"UpdateActiveTarget\",\r\n          this.activeStack[this.activeStack.length - 1]\r\n        );\r\n      },\r\n      this.options\r\n    );\r\n\r\n    el[\"_intersectForScrollToTarget\"] = Object(el[\"_intersectForScrollToTarget\"]);\r\n    el[\"_intersectForScrollToTarget\"] = { handle: this.handle, observer };\r\n\r\n    observer.observe(el);\r\n  }\r\n\r\n  unobserve(id: string) {\r\n    const el = document.getElementById(id);\r\n    if (!el) return;\r\n\r\n    const observe = el[\"_intersectForScrollToTarget\"];\r\n    if (!observe) return;\r\n\r\n    observe.observer.unobserve(el);\r\n    delete el[\"_intersectForScrollToTarget\"];\r\n  }\r\n\r\n  dispose() {\r\n    if (this.handle) {\r\n      this.handle.dispose();\r\n      this.handle = null\r\n    }\r\n  }\r\n}\r\n\r\nfunction init(\r\n  handle: DotNet.DotNetObject,\r\n  options?: IntersectionObserverOptions\r\n) {\r\n  return new ScrollToTargetJSInterop(handle, options);\r\n}\r\n\r\nexport { init };\r\n"],"names":[],"mappings":";;;;AAEA,MAAM,uBAAuB,CAAA;IAK3B,WACE,CAAA,MAA2B,EAC3B,OAAqC,EAAA;QANvC,IAAW,CAAA,WAAA,GAAa,EAAE,CAAC;AAQzB,QAAA,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;AACrB,QAAA,IAAI,CAAC,OAAO,GAAG,uBAAuB,CAAC,OAAO,CAAC,CAAC;KACjD;AAED,IAAA,OAAO,CAAC,EAAU,EAAA;QAChB,MAAM,EAAE,GAAG,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;QACvC,IAAI,CAAC,EAAE,EAAE;AACP,YAAA,OAAO,CAAC,IAAI,CAAC,qCAAqC,EAAE,CAAA,WAAA,CAAa,CAAC,CAAC;YACnE,OAAO;AACR,SAAA;AAED,QAAA,IAAI,EAAE,CAAC,6BAA6B,CAAC,EAAE;YACrC,OAAO;AACR,SAAA;QAED,MAAM,QAAQ,GAAG,IAAI,oBAAoB,CACvC,CACE,OAAA,GAAuC,EAAE,EACzC,QAA8B,KAC5B,SAAA,CAAA,IAAA,EAAA,KAAA,CAAA,EAAA,KAAA,CAAA,EAAA,aAAA;AACF,YAAA,MAAM,cAAc,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,cAAc,CAAC,CAAC;AAC7D,YAAA,IAAI,cAAc,EAAE;AAClB,gBAAA,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;AAC3B,aAAA;iBAAM,IAAI,IAAI,CAAC,WAAW,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE;AACxC,gBAAA,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC;AAC1D,aAAA;YAED,MAAM,IAAI,CAAC,MAAM,CAAC,iBAAiB,CACjC,oBAAoB,EACpB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC,CAC9C,CAAC;AACJ,SAAC,CAAA,EACD,IAAI,CAAC,OAAO,CACb,CAAC;QAEF,EAAE,CAAC,6BAA6B,CAAC,GAAG,MAAM,CAAC,EAAE,CAAC,6BAA6B,CAAC,CAAC,CAAC;AAC9E,QAAA,EAAE,CAAC,6BAA6B,CAAC,GAAG,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,QAAQ,EAAE,CAAC;AAEtE,QAAA,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;KACtB;AAED,IAAA,SAAS,CAAC,EAAU,EAAA;QAClB,MAAM,EAAE,GAAG,QAAQ,CAAC,cAAc,CAAC,EAAE,CAAC,CAAC;AACvC,QAAA,IAAI,CAAC,EAAE;YAAE,OAAO;AAEhB,QAAA,MAAM,OAAO,GAAG,EAAE,CAAC,6BAA6B,CAAC,CAAC;AAClD,QAAA,IAAI,CAAC,OAAO;YAAE,OAAO;AAErB,QAAA,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;AAC/B,QAAA,OAAO,EAAE,CAAC,6BAA6B,CAAC,CAAC;KAC1C;IAED,OAAO,GAAA;QACL,IAAI,IAAI,CAAC,MAAM,EAAE;AACf,YAAA,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE,CAAC;AACtB,YAAA,IAAI,CAAC,MAAM,GAAG,IAAI,CAAA;AACnB,SAAA;KACF;AACF,CAAA;AAED,SAAS,IAAI,CACX,MAA2B,EAC3B,OAAqC,EAAA;AAErC,IAAA,OAAO,IAAI,uBAAuB,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;AACtD;;;;"}