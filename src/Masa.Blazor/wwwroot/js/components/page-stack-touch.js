function t(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)}var e,n;"function"==typeof SuppressedError&&SuppressedError;class i{constructor(t){this.size=t,e.set(this,[]),n.set(this,0)}push(i){t(this,e,"f")[t(this,n,"f")]=i,function(t,e,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");"a"===i?o.call(t,n):o?o.value=n:e.set(t,n)}(this,n,(t(this,n,"f")+1)%this.size,"f")}values(){return t(this,e,"f").slice(t(this,n,"f")).concat(t(this,e,"f").slice(0,t(this,n,"f")))}}e=new WeakMap,n=new WeakMap;function o(t){return(t<0?-1:1)*Math.sqrt(Math.abs(t))*1.41421356237}function r(t){if(t.length<2)return 0;if(2===t.length)return t[1].t===t[0].t?0:(t[1].d-t[0].d)/(t[1].t-t[0].t);let e=0;for(let n=t.length-1;n>0;n--){if(t[n].t===t[n-1].t)continue;const i=o(e),r=(t[n].d-t[n-1].d)/(t[n].t-t[n-1].t);e+=(r-i)*Math.abs(r),n===t.length-1&&(e*=.5)}return 1e3*o(e)}function s(){const t={};return{addMovement:function(e){Array.from(e.changedTouches).forEach((n=>{var o;(null!==(o=t[n.identifier])&&void 0!==o?o:t[n.identifier]=new i(20)).push([e.timeStamp,n])}))},endTouch:function(e){Array.from(e.changedTouches).forEach((e=>{delete t[e.identifier]}))},getVelocity:function(e){var n;const i=null===(n=t[e])||void 0===n?void 0:n.values().reverse();if(!i)throw new Error(`No samples for touch id ${e}`);const o=i[0],s=[],c=[];for(const t of i){if(o[0]-t[0]>100)break;s.push({t:t[0],d:t[1].clientX}),c.push({t:t[0],d:t[1].clientY})}return{x:r(s),y:r(c),get direction(){const{x:t,y:e}=this,[n,i]=[Math.abs(t),Math.abs(e)];return n>i&&t>=0?"right":n>i&&t<=0?"left":i>n&&e>=0?"down":i>n&&e<=0?"up":function(){throw new Error}()}}}}}const c="undefined"!=typeof window;let a=!1;try{if(c){const t=Object.defineProperty({},"passive",{get:()=>{a=!0}});window.addEventListener("testListener",t,t),window.removeEventListener("testListener",t,t)}}catch(t){console.warn(t)}function d(t,e,n){const i=function(t){return"string"==typeof t?document.querySelector(t):t}(t);if(!i)return;window.addEventListener("touchstart",g,{passive:!0}),window.addEventListener("touchmove",y,{passive:!1}),window.addEventListener("touchend",E,{passive:!0});const o=["left","right"].includes(n.position),{addMovement:r,endTouch:c,getVelocity:a}=s();let d,h=!1,f=!1,l=0,m=0;function p(t,e){return("left"===n.position?t:"right"===n.position?document.documentElement.clientWidth-t:u())-(e?document.documentElement.clientWidth:0)}function w(t,e=!0){const i="left"===n.position?(t-m)/document.documentElement.clientWidth:"right"===n.position?(document.documentElement.clientWidth-t-m)/document.documentElement.clientWidth:u();return e?Math.max(0,Math.min(1,i)):i}function v(t){return t.target.closest(".m-page-stack-item").parentElement===i}function g(t){if(!v(t))return;const e=t.changedTouches[0].clientX,i=t.changedTouches[0].clientY,s="left"===n.position?e<25:"right"===n.position?e>document.documentElement.clientWidth-25:u(),a=n.isActive&&("left"===n.position?e<document.documentElement.clientWidth:"right"===n.position?e>0:u());(s||a||n.isActive)&&(d=[e,i],m=p(o?e:i,n.isActive),l=w(o?e:i),h=m>-20&&m<80,c(t),r(t))}function y(t){if(!v(t))return;const e=t.changedTouches[0].clientX,n=t.changedTouches[0].clientY;if(h){if(!t.cancelable)return void(h=!1);const i=Math.abs(e-d[0]),r=Math.abs(n-d[1]);(o?i>r&&i>3:r>i&&r>3)?(f=!0,h=!1):(o?r:i)>3&&(h=!1)}if(!f)return;t.preventDefault(),r(t);const i=w(o?e:n,!1);l=Math.max(0,Math.min(1,i)),i>1?m=p(o?e:n,!0):i<0&&(m=p(o?e:n,!1)),b()}function E(t){if(!v(t))return;if(h=!1,!f)return;r(t),f=!1;const i=a(t.changedTouches[0].identifier),s=Math.abs(i.x),c=Math.abs(i.y),d=o?s>c&&s>400:c>s&&c>3;n.isActive=d?i.direction===({left:"right",right:"left",top:"down",bottom:"up"}[n.position]||u()):l>.5,b(),setTimeout((()=>e.invokeMethodAsync("TouchEnd",n.isActive)),200)}const b=()=>{if(f){const t="left"===n.position?`translateX(calc(-100% + ${l*document.documentElement.clientWidth}px))`:"right"===n.position?`translateX(calc(100% - ${l*document.documentElement.clientWidth}px))`:u();i.style.setProperty("transform",t),i.style.setProperty("transition","none")}else n.isActive?i.style.removeProperty("transform"):i.style.setProperty("transform","translateX(100%)"),i.style.removeProperty("transition")};return{syncState:t=>{n=t},dispose:()=>{e.dispose(),window.removeEventListener("touchstart",g),window.removeEventListener("touchmove",y),window.removeEventListener("touchend",E)}}}function u(){throw new Error}Object.freeze({enter:13,tab:9,delete:46,esc:27,space:32,up:38,down:40,left:37,right:39,end:35,home:36,del:46,backspace:8,insert:45,pageup:33,pagedown:34,shift:16});export{d as useTouch};
//# sourceMappingURL=page-stack-touch.js.map
